"use strict";

const gpio = require("../gpio");

const INPUT_PIN1 = 21;
const INPUT_PIN2 = 20;
const DEBOUNCE_US = 1000; // us

// init watch INPUT_PIN1
var state = gpio.watch_gpio(INPUT_PIN1, gpio.GPIO_MODE_INPUT_PULLUP, DEBOUNCE_US, gpio.GPIO_EDGE_BOTH,
    (state, edge) => {
        console.log("pin", INPUT_PIN1, "state", state, "edge", edge);
});

if (state === undefined)
    console.log("error on watch", INPUT_PIN1);
else
    console.log("pin", INPUT_PIN1, "actual state", state);

// init watch INPUT_PIN2
state = gpio.watch_gpio(INPUT_PIN2, gpio.GPIO_MODE_INPUT_PULLUP, DEBOUNCE_US, gpio.GPIO_EDGE_RISING,
    (state, edge) => {
        console.log("pin", INPUT_PIN2, "state", state, "edge", edge);
});

if (state === undefined)
    console.log("error on watch", INPUT_PIN2);
else
    console.log("pin", INPUT_PIN2, "actual state", state);

console.log("*** watch example ***");
console.log("stop program with Ctrl+C");

// handle Ctrl+C
process.on('SIGINT', () => {
    gpio.deinit_gpio(INPUT_PIN1);
    gpio.deinit_gpio(INPUT_PIN2);
    console.log(" -> program stopped");
    process.exit();
});